meta(charset='utf-8')
meta(name='viewport' content='width=device-width initial-scale=1 viewport-fit=cover')
meta(name='theme-color' content='#282A2E' media='(prefers-color-scheme: dark)')
meta(name='theme-color' content='#DDDDDD' media='(prefers-color-scheme: light)')

// Add no-js class to html element when JavaScript is disabled
script.
	document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/, '');
	document.documentElement.className += ' js';

style.
	/* Theme selector styles */
	.no-js-theme-selector {
		display: none;
		position: fixed;
		top: 50%;
		left: 50%;
		transform: translate(-50%, -50%);
		background: var(--background);
		padding: 1rem;
		border: 1px solid var(--border);
		border-radius: 4px;
		z-index: 1000;
	}
	.no-js-theme-selector:target {
		display: block;
	}
	html.no-js .no-js-theme-selector {
		display: block;
	}
	html:not(.no-js) .no-js-theme-selector {
		display: none;
	}
	html.no-js #no-js-settings {
		display: block;
	}
	html:not(.no-js) #no-js-settings {
		display: none;
	}
	.theme-select-group {
		margin: 1rem 0;
	}
	.theme-select-group label {
		display: block;
		margin-bottom: 0.5rem;
	}
	.theme-select-group select {
		width: 100%;
		padding: 0.5rem;
	}
	.theme-form button {
		width: 100%;
		padding: 0.5rem;
		margin-top: 1rem;
	}
	/* Show theme selector button only when JS is disabled */
	#no-js-settings {
		display: none;
	}
	html:not(.js) #no-js-settings {
		display: inline-block;
	}

//- very basic styles to hide some elements and improve experience for users with noscript
noscript
	style.
		.jsonly { display: none!important; }
		.user-id { cursor: auto!important; }

//- whether this page is rendered for a board
- const isBoard = board != null;

//- general meta and opengraph meta tags
if isBoard
	if board.settings.description
		meta(name='description' content=board.settings.description)
	if board.settings.tags
		meta(name='keywords' content=board.settings.tags.join(','))
meta(property='og:site_name', value=meta.siteName)
meta(property='og:url', content=meta.url)

//- main stylesheet
link(rel='stylesheet' href=`/css/style.css?v=${commit}&ct=${captchaOptions.type}`)

//- theme stylesheets
- const theme = isBoard ? board.settings.theme : defaultTheme;
link#theme(rel='stylesheet' data-theme=theme href=`/css/themes/${theme}.css`)
- const codeTheme = isBoard ? board.settings.codeTheme : defaultCodeTheme;
link#codetheme(rel='stylesheet' data-theme=codeTheme href=`/css/codethemes/${codeTheme}.css`)
if isBoard && board.settings.customCss
	style#board-customcss #{board.settings.customCss}

//- include html_code from gulp-favicon
include ../../gulp/res/icons/html_code.html

//- language pack
- const pageLanguage = isBoard ? board.settings.language : (locale || globalLanguage);
script(src=`/js/lang/${pageLanguage}.js?v=${commit}`)

//- main script
script(src=`/js/all.js?v=${commit}&ct=${captchaOptions.type}`)

//- optional web3 script
if enableWeb3 || isBoard && board.settings.enableWeb3
	script(src=`/js/web3.js?v=${commit}`)

//- additional scripts included only if hcaptcha, recaptcha, or yandex smartcaptcha are used
if captchaOptions.type === 'google'
	script(src='https://www.google.com/recaptcha/api.js' async defer)
if captchaOptions.type === 'hcaptcha'
	script(src='https://hcaptcha.com/1/api.js' async defer)
if captchaOptions.type === 'yandex'
	script(src='https://smartcaptcha.yandexcloud.net/captcha.js' async defer)

// Add a no-JS settings button that will be visible when JavaScript is disabled
a.nav-item.right#no-js-settings(href="#theme-settings" data-label="Settings") Settings

// Add a no-JS theme selector section
div#theme-settings.no-js-theme-selector
	h3 Theme Settings
	form.theme-form(action="/forms/settheme" method="GET")
		input(type="hidden" name="redirectTo" value=meta.url)
		.theme-select-group
			label(for="no-js-theme") Theme:
			select(name="theme" id="no-js-theme")
				option(value="default") Default
				each theme in themes
					option(value=theme selected=theme === currentTheme) #{theme}
		.theme-select-group
			label(for="no-js-codetheme") Code Theme:
			select(name="codetheme" id="no-js-codetheme")
				option(value="default") Default
				each theme in codeThemes
					option(value=theme selected=theme === currentCodeTheme) #{theme}
		button(type="submit") Apply Theme
